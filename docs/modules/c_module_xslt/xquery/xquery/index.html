<!doctype html><html lang=fr dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  XQuery
  #

XSLT peut servir pour extraire des informations d&rsquo;un document XML. On peut trouver tous les noms des étudiants répondant à certains critères. Dans un sens, XSLT peut être utilisé comme langage dans le contexte des bases de données. Cependant, pour cette fin spécifique, un nouveau langage appelé XQuery a été proposé. La syntaxe du XQuery est un mélange de XPath et de SQL et ressemble davantage à ce que les spécialistes des bases de données connaissent bien."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://lemire.github.io/orientee_donnees/docs/modules/c_module_xslt/xquery/xquery/"><meta property="og:site_name" content="Programmation orientée-données"><meta property="og:title" content="XQuery"><meta property="og:description" content="XQuery # XSLT peut servir pour extraire des informations d’un document XML. On peut trouver tous les noms des étudiants répondant à certains critères. Dans un sens, XSLT peut être utilisé comme langage dans le contexte des bases de données. Cependant, pour cette fin spécifique, un nouveau langage appelé XQuery a été proposé. La syntaxe du XQuery est un mélange de XPath et de SQL et ressemble davantage à ce que les spécialistes des bases de données connaissent bien."><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>XQuery | Programmation orientée-données</title><link rel=icon href=/orientee_donnees/favicon.png><link rel=manifest href=/orientee_donnees/manifest.json><link rel=canonical href=https://lemire.github.io/orientee_donnees/docs/modules/c_module_xslt/xquery/xquery/><link rel=stylesheet href=/orientee_donnees/book.min.a006656c8516e75b9916bf87553cdae09b7d022a0ef8c51fcafcb935e4e3d410.css integrity="sha256-oAZlbIUW51uZFr+HVTza4Jt9AioO+MUfyvy5NeTj1BA=" crossorigin=anonymous><script defer src=/orientee_donnees/fuse.min.js></script><script defer src=/orientee_donnees/fr.search.min.04024c4c02a6937ed16904d6f5f3905adad4ab6eb5a7bbbe2bed9558d5022fb7.js integrity="sha256-BAJMTAKmk37RaQTW9fOQWtrUq261p7u+K+2VWNUCL7c=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/orientee_donnees/><img src=/orientee_donnees/favicon.png alt=Logo class=book-icon><span>Programmation orientée-données</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Rechercher aria-label=Rechercher maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><span>Modules</span><ul><li><input type=checkbox id=section-e0cc4658cb7e0b0785f48bc734a0d868 class=toggle>
<label for=section-e0cc4658cb7e0b0785f48bc734a0d868 class=flex><a href=/orientee_donnees/docs/modules/a_module_json/ class=flex-auto>Module JSON</a></label><ul><li><a href=/orientee_donnees/docs/modules/a_module_json/json/>JSON</a></li><li><a href=/orientee_donnees/docs/modules/a_module_json/geojson/>GeoJSON</a></li><li><a href=/orientee_donnees/docs/modules/a_module_json/markdown/>MarkDown</a></li><li><a href=/orientee_donnees/docs/modules/a_module_json/jq/>Activité avec jq</a></li><li><a href=/orientee_donnees/docs/modules/a_module_json/gjson/>Google Gson</a></li><li><a href=/orientee_donnees/docs/modules/a_module_json/encodage_des_caracteres_unicode/>Encodage des caractères Unicode</a></li><li><a href=/orientee_donnees/docs/modules/a_module_json/travail/>Travail noté</a></li></ul></li><li><input type=checkbox id=section-5dba5cff8314754d322613989dda2ee4 class=toggle>
<label for=section-5dba5cff8314754d322613989dda2ee4 class=flex><a href=/orientee_donnees/docs/modules/b_module_xml/ class=flex-auto>Module XML</a></label><ul><li><input type=checkbox id=section-b0f20b451fe2916a31453d5cbda26a99 class=toggle>
<label for=section-b0f20b451fe2916a31453d5cbda26a99 class=flex><a role=button class=flex-auto>Les fondements</a></label><ul><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/introduction_a_xml/>Introduction à XML</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/principes_du_xml/>Principes du XML</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/creer_un_fichier_xml/>Créer un fichier XML</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/mise_en_forme_du_xml/>Mise en forme du XML</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/laboratoire_sur_la_structure_en_arbre_des_documents_xml/>Laboratoire sur la structure en arbre des documents XML</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/labo/>Vérificateur de XML bien formé</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/base/autoevaluation/>Autoévaluation XML</a></li></ul></li><li><input type=checkbox id=section-344b47eee8a14c6b3ccb143c1f5bf702 class=toggle>
<label for=section-344b47eee8a14c6b3ccb143c1f5bf702 class=flex><a role=button class=flex-auto>Validation</a></label><ul><li><a href=/orientee_donnees/docs/modules/b_module_xml/valid/definition_de_type_de_document/>Définition de type de document</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/valid/validation_de_documents_xml/>Validation de documents XML</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/valid/autoevaluation_dtd/>Autoévaluation</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/valid/docx_microsoft_word/>Docx (Microsoft Word)</a></li></ul></li><li><input type=checkbox id=section-d96b044d241e9b77e9c0592b528dc057 class=toggle>
<label for=section-d96b044d241e9b77e9c0592b528dc057 class=flex><a role=button class=flex-auto>Espaces de nom</a></label><ul><li><a href=/orientee_donnees/docs/modules/b_module_xml/espaces/espace_de_nom/>Espace de noms</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/espaces/autoevaluation_adv/>Autoévaluation</a></li></ul></li><li><input type=checkbox id=section-7677844365e3481ee5b7c1ca5bb4c38f class=toggle>
<label for=section-7677844365e3481ee5b7c1ca5bb4c38f class=flex><a role=button class=flex-auto>Exemples</a></label><ul><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/le_fichier_pomxml_en_java/>Le fichier pom.xml en Java</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/le_fichier_sitemapxml/>Le fichier sitemap.xml</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/les_fichiers_csproj_en_c/>Les fichiers csproj en C#</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/rss/>Les formats RSS et Atom</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/three/>X3D</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/le_fichier_androidmanifestxml/>Le fichier AndroidManifest.xml</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/examples/jackson/>Activité JSON/XML avec Jackson</a></li></ul></li><li><input type=checkbox id=section-3414f79d7e98c78ad1d3dbda25a1f55a class=toggle>
<label for=section-3414f79d7e98c78ad1d3dbda25a1f55a class=flex><a role=button class=flex-auto>RDF</a></label><ul><li><a href=/orientee_donnees/docs/modules/b_module_xml/rdf/introduction_au_rdf/>Introduction au RDF</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/rdf/applications_du_rdf/>Applications du RDF</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/rdf/autoevaluation_rdf/>Autoévaluation</a></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/rdf/sparql/>Activité SPARQL</a></li></ul></li><li><a href=/orientee_donnees/docs/modules/b_module_xml/travail/>Travail noté</a></li></ul></li><li><input type=checkbox id=section-5d65d8b100e58c6d134cd4da58e1cd2c class=toggle checked>
<label for=section-5d65d8b100e58c6d134cd4da58e1cd2c class=flex><a href=/orientee_donnees/docs/modules/c_module_xslt/ class=flex-auto>Module XPath, XSLT, XQuery</a></label><ul><li><input type=checkbox id=section-7ac06c5c6cb170ae259ae8aaa0f2fa28 class=toggle>
<label for=section-7ac06c5c6cb170ae259ae8aaa0f2fa28 class=flex><a role=button class=flex-auto>XPath</a></label><ul><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xpath/xpath_un_premier_laboratoire/>XPath : un premier laboratoire</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xpath/xpath_approfondissement/>XPath : approfondissement</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xpath/xpath_en_ligne_java/>XPath avec Java</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xpath/xpath_second_laboratoire/>XPath : second laboratoire</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xpath/autoevaluation_xpath/>Autoévaluation</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xpath/xpath_20_et_30/>XPath 2.0 et 3.0</a></li></ul></li><li><input type=checkbox id=section-f547d6e3d6ea0eaec3e702c4dfd2c47e class=toggle>
<label for=section-f547d6e3d6ea0eaec3e702c4dfd2c47e class=flex><a role=button class=flex-auto>XSLT</a></label><ul><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/introduction_au_xslt/>Introduction au XSLT</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/xslt_en_ligne/>XSLT en ligne</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/xslt_en_ligne_java/>XSLT avec Java</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/un_peu_plus_de_xslt_fonctionnement_de_base_template_et_value-of/>Un peu plus de XSLT : fonctionnement de base, template et value-of</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/les_valeurs_dattribut/>Les valeurs d’attribut</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/xslt_modulaire/>XSLT modulaire</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/les_noms_delements/>Les noms d’éléments</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/attribut_mode/>Attribut mode</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/la_fonction_generate-id/>La fonction generate-id</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/les_tests/>Les tests</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/les_boucles/>Les boucles</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/cles_et_aggregation/>Clés et aggrégation</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/generer_des_noeuds_dynamiquement/>Générer des noeuds dynamiquement</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/variables_et_parametres/>Variables et paramètres</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/mise_en_forme/>Mise en forme</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/espaces_de_noms/>Espaces de noms</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/les_axes/>Les axes</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/etude_dun_exemple_docbook/>Étude d’un exemple (DocBook)</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/laboratoire_xslt/>Laboratoire XSLT</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/laboratoire_xslt_avec_python_optionnel/>Laboratoire XSLT avec Python (optionnel)</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/xslt_20_et_30/>XSLT 2.0 et 3.0</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/autoevaluation_xslt/>Autoévaluation</a></li></ul></li><li><input type=checkbox id=section-b3c85205c7eb5b729c0be10ddbd24290 class=toggle checked>
<label for=section-b3c85205c7eb5b729c0be10ddbd24290 class=flex><a role=button class=flex-auto>XQuery</a></label><ul><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xquery/xquery/ class=active>XQuery</a></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/xquery/laboratoire_xquery_avec_python_optionnel/>Laboratoire XQuery avec Python (optionnel)</a></li></ul></li><li><a href=/orientee_donnees/docs/modules/c_module_xslt/travail/>Travail noté</a></li></ul></li><li><input type=checkbox id=section-2a04c3a72cdb954ae36ef63df297319a class=toggle>
<label for=section-2a04c3a72cdb954ae36ef63df297319a class=flex><a href=/orientee_donnees/docs/modules/d_module_html/ class=flex-auto>Module HTML, CSS, SVG, MathML</a></label><ul><li><a href=/orientee_donnees/docs/modules/d_module_html/xhtml/>XHTML</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/html_5/>HTML 5</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/autoevaluation/>Autoévaluation HTML</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/css/>CSS</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/css2/>CSS (partie 2)</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/css3/>CSS (partie 3)</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/laboratoire_css/>Laboratoire CSS</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/svg/>SVG</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/mathml/>MathML</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/cssmathml/>Laboratoire CSS/MathML</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/autoevaluation_css/>Autoévaluation CSS</a></li><li><a href=/orientee_donnees/docs/modules/d_module_html/travail/>Travail noté</a></li></ul></li><li><input type=checkbox id=section-d04fad4b07d7c0c5b266f3694fc3c8af class=toggle>
<label for=section-d04fad4b07d7c0c5b266f3694fc3c8af class=flex><a href=/orientee_donnees/docs/modules/e_module_services/ class=flex-auto>Module Services et YAML</a></label><ul><li><a href=/orientee_donnees/docs/modules/e_module_services/serveurweb/>Serveur Web Java</a></li><li><a href=/orientee_donnees/docs/modules/e_module_services/base64/>Base64</a></li><li><a href=/orientee_donnees/docs/modules/e_module_services/asynchronous_javascript_and_xml_ajax/>Asynchronous JavaScript And XML (AJAX)</a></li><li><a href=/orientee_donnees/docs/modules/e_module_services/introservicesweb/>Introduction aux services web</a></li><li><a href=/orientee_donnees/docs/modules/e_module_services/serviceweb/>Création d'un service web</a></li><li><a href=/orientee_donnees/docs/modules/e_module_services/yaml/>YAML</a></li><li><a href=/orientee_donnees/docs/modules/e_module_services/travail/>Travail noté</a></li></ul></li><li><a href=/orientee_donnees/docs/modules/travail_integration/>Travail d'intégration</a></li><li><a href=/orientee_donnees/docs/modules/evaluation/>Évaluation</a></li><li><a href=/orientee_donnees/docs/modules/glossaire/>Glossaire</a></li><li><a href=/orientee_donnees/docs/modules/pense-bete_xml/>Pense-bête XML</a></li><li><a href=/orientee_donnees/docs/modules/pense-bete_json/>Pense-bête JSON</a></li><li><a href=/orientee_donnees/docs/modules/pense-bete_yaml/>Pense-bête YAML</a></li><li><a href=/orientee_donnees/docs/modules/professeur/>Professeur</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/orientee_donnees/svg/menu.svg class=book-icon alt=Menu></label><h3>XQuery</h3><label for=toc-control><img src=/orientee_donnees/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#saxon-en-ligne>Saxon en ligne</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=xquery>XQuery
<a class=anchor href=#xquery>#</a></h1><p>XSLT peut servir pour extraire des informations d&rsquo;un document XML. On peut trouver tous les noms des étudiants répondant à certains critères. Dans un sens, XSLT peut être utilisé comme langage dans le contexte des bases de données. Cependant, pour cette fin spécifique, un nouveau langage appelé XQuery a été proposé. La syntaxe du XQuery est un mélange de XPath et de <a href=http://fr.wikipedia.org/wiki/SQL>SQL</a> et ressemble davantage à ce que les spécialistes des bases de données connaissent bien.</p><p>Pour tester les requêtes XQuery, Saxon est un outil pratique écrit en java. Pour utiliser Saxon,
suivez d&rsquo;abord les consignes à l&rsquo;adresse <a href=https://github.com/lemire/javasaxon>https://github.com/lemire/javasaxon</a>.</p><p>Pour rendre nos exemples plus concrets, prenez le fichier etu.xml suivant.</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#0550ae>&lt;liste&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;nom&gt;</span>Laroche<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;prenom&gt;</span>Pierre<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;statut&gt;</span>inscrit<span style=color:#0550ae>&lt;/statut&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;cours&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;sigle&gt;</span>INF 6460<span style=color:#0550ae>&lt;/sigle&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;note&gt;</span>54<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;/cours&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;cours&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;sigle&gt;</span>INF 6450<span style=color:#0550ae>&lt;/sigle&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;note&gt;</span>44<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;/cours&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;nom&gt;</span>Aaron<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;prenom&gt;</span>Jean<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;statut&gt;</span>inscrit<span style=color:#0550ae>&lt;/statut&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;cours&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;sigle&gt;</span>INF 6460<span style=color:#0550ae>&lt;/sigle&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;note&gt;</span>56<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;/cours&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;cours&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;sigle&gt;</span>INF 6450<span style=color:#0550ae>&lt;/sigle&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;note&gt;</span>46<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;/cours&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;nom&gt;</span>Pouf<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;prenom&gt;</span>Jean<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#0550ae>&lt;statut&gt;</span>non-inscrit<span style=color:#0550ae>&lt;/statut&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&lt;/liste&gt;</span>
</span></span></code></pre></div><p>Vous pouvez créer un fichier etu.xml sur votre disque dans le même dossier que le fichier query, et remplacer partout l&rsquo;URI par le nom du fichier (tel que « etu.xml »).</p><p>Parce que XQuery, tout comme XSLT 2.0, s&rsquo;appuie sur XPath 2.0, il est facile de calculer la liste des cours :</p><pre tabindex=0><code class=language-xquery data-lang=xquery>for $s in distinct-values(doc(&#34;etu.xml&#34;)//sigle)
    return $s
</code></pre><p>Cette requête donnera « INF 6460 INF 6450 ».</p><p>Voici un exemple de requête XQuery pour extraire d&rsquo;un document XML tous les étudiants inscrits en supposant que le fichier XML se trouve à l&rsquo;adresse <a href=http://universite.com/etu.xml>http://universite.com/etu.xml</a>.</p><pre tabindex=0><code class=language-xquery data-lang=xquery>&lt;maliste&gt;
    {let $inscription := &#34;inscrit&#34;
    for $b in doc(&#34;http://universite.com/etu.xml&#34;)/liste/etudiant
    where $b/statut = $inscription
    order by $b/nom ascending
    return &lt;etudiant&gt;
    { $b/prenom }
    { $b/nom }
    &lt;/etudiant&gt;}
&lt;/maliste&gt;
</code></pre><p>Cet exemple est une requête de type FLWOR parce qu&rsquo;elle ne contient que des instructions « for », « let », « where », « order by », et « return ». L&rsquo;instruction « for » sert à définir une boucle, l&rsquo;instruction « where » sert à poser une condition, l&rsquo;instruction « order by » permet de trier le résultat, alors que l&rsquo;instruction « return » définit le résultat. L&rsquo;instruction « let » permet de définir une constante. Notez que XQuery utilise les accolades pour distinguer les requêtes XQuery et XPath du texte. La requête considère tous les éléments etudiant contenus dans l&rsquo;élément-racine liste, pour chacun d&rsquo;entre eux, elle vérifie qu&rsquo;il contient un élément statut contenant le texte « inscrit », puis elle donne la liste des noms et prénoms triée selon le nom. Voici quel sera le résultat :</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#0550ae>&lt;maliste&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;prenom&gt;</span>Jean<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;nom&gt;</span>Aaron<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;prenom&gt;</span>Pierre<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;nom&gt;</span>Laroche<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&lt;/maliste&gt;</span>
</span></span></code></pre></div><p>On peut attribuer un compteur aux nœuds :</p><pre tabindex=0><code class=language-xquery data-lang=xquery>&lt;maliste&gt;
    {
    for $b at $pos in doc(&#34;http://universite.com/etu.xml&#34;)/liste/etudiant
    order by $b/nom descending
    return
    &lt;etudiant&gt; $pos -
    { $b/prenom }
    { $b/nom }
    &lt;/etudiant&gt;
    }
&lt;/maliste&gt;
</code></pre><p>Le résultat sera alors :</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#0550ae>&lt;maliste&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>3-
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;prenom&gt;</span>Jean<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;nom&gt;</span>Pouf<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>1-
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;prenom&gt;</span>Pierre<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;nom&gt;</span>Laroche<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant&gt;</span>2-
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;prenom&gt;</span>Jean<span style=color:#0550ae>&lt;/prenom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;nom&gt;</span>Aaron<span style=color:#0550ae>&lt;/nom&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&lt;/maliste&gt;</span>
</span></span></code></pre></div><p>On peut combiner les requêtes FLWOR, comme dans cet exemple :</p><pre tabindex=0><code class=language-xquery data-lang=xquery>&lt;maliste&gt;
    {for $e in doc(&#34;http://universite.com/etu.xml&#34;)//etudiant
    return
    &lt;etudiant nom=&#34;{$e/nom}&#34;&gt;
    { for $v in $e/cours return
    &lt;note&gt;{number($v/note)}&lt;/note&gt;
    }
    &lt;/etudiant&gt;
    }
&lt;/maliste&gt;
</code></pre><p>Cette requête va considérer chaque élément etudiant du document XML et créer une liste de notes obtenues pour cet étudiant, dans ce cas, le résultat sera :</p><div class=highlight><pre tabindex=0 style=background-color:#f7f7f7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#0550ae>&lt;maliste&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant</span> <span style=color:#1f2328>nom=</span><span style=color:#0a3069>&#34;Laroche&#34;</span><span style=color:#0550ae>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;note&gt;</span>54<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;note&gt;</span>44<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant</span> <span style=color:#1f2328>nom=</span><span style=color:#0a3069>&#34;Aaron&#34;</span><span style=color:#0550ae>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;note&gt;</span>56<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;note&gt;</span>46<span style=color:#0550ae>&lt;/note&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;/etudiant&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;etudiant</span> <span style=color:#1f2328>nom=</span><span style=color:#0a3069>&#34;Pouf&#34;</span><span style=color:#0550ae>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&lt;/maliste&gt;</span>
</span></span></code></pre></div><p>L&rsquo;expression suivante va calculer la moyenne de notes (50) :</p><pre tabindex=0><code class=language-xquery data-lang=xquery>&lt;maliste&gt;
    {avg(
    for $n in doc(&#34;http://universite.com/etu.xml&#34;)//note
    return $n
    )}
&lt;/maliste&gt;
</code></pre><p>Par défaut, les documents XQuery utilisent le jeu de caractères Unicode UTF-8. On peut stipuler un jeu de caractères différent dans la déclaration XQuery optionnelle comme dans cet exemple :</p><pre tabindex=0><code class=language-xquery data-lang=xquery>xquery version &#34;1.0&#34; encoding &#34;utf-8&#34;;
    for $s in distinct-values(doc(&#34;etu.xml&#34;)//sigle)
    return $s
</code></pre><p>Elliotte Rusty Harold nous offre une excellente <a href=http://www.cafeconleche.org/slides/albany/xquery/>page sur XQuery</a> qui résume bien les points essentiels avec des exemples.</p><h2 id=saxon-en-ligne>Saxon en ligne
<a class=anchor href=#saxon-en-ligne>#</a></h2><p>Vous pouvez aussi tester Saxon en ligne pour exécuter des requêtes XQuery.</p><div class=java-inline><div id=java-runner-1767046077463918336><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1767046077463918336 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1767046077463918336 .export-form{margin-bottom:0}#java-runner-1767046077463918336 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1767046077463918336 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1767046077463918336 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1767046077463918336 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1767046077463918336 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0!important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0!important}</style><form class="export-form java-runner-1767046077463918336-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>Main.java</div><textarea>
import net.sf.saxon.s9api.*;

import java.io.StringWriter;

public class Main {
    public static void main(String[] args) {
        // XML intégré directement dans le code Java (chaîne multi-ligne)
        String xmlContent = &#34;&#34;&#34;
            &lt;bibliotheque&gt;
                &lt;livre&gt;
                    &lt;titre&gt;Le Petit Prince&lt;/titre&gt;
                    &lt;auteur&gt;Antoine de Saint-Exupéry&lt;/auteur&gt;
                    &lt;annee&gt;1943&lt;/annee&gt;
                &lt;/livre&gt;
                &lt;livre&gt;
                    &lt;titre&gt;1984&lt;/titre&gt;
                    &lt;auteur&gt;George Orwell&lt;/auteur&gt;
                    &lt;annee&gt;1949&lt;/annee&gt;
                &lt;/livre&gt;
                &lt;livre&gt;
                    &lt;titre&gt;Le Seigneur des Anneaux&lt;/titre&gt;
                    &lt;auteur&gt;J.R.R. Tolkien&lt;/auteur&gt;
                    &lt;annee&gt;1954&lt;/annee&gt;
                &lt;/livre&gt;
            &lt;/bibliotheque&gt;
            &#34;&#34;&#34;;

        // Requête XQuery qui construit le document à partir de la chaîne
        String xquery = &#34;&#34;&#34;
            declare variable $doc external;
            &lt;resultats&gt;{
                for $livre in $doc//livre
                return &lt;titre&gt;{data($livre/titre)}&lt;/titre&gt;
            }&lt;/resultats&gt;
            &#34;&#34;&#34;;

        try {
            Processor processor = new Processor(false);  // Saxon-HE
            DocumentBuilder builder = processor.newDocumentBuilder();

            // Construction du document XML à partir de la chaîne
            XdmNode document = builder.build(
                new javax.xml.transform.stream.StreamSource(
                    new java.io.StringReader(xmlContent)
                )
            );

            XQueryCompiler compiler = processor.newXQueryCompiler();
            // Déclaration de la variable externe $doc
            compiler.declareNamespace(&#34;&#34;, &#34;&#34;);  // namespace par défaut si nécessaire
            XQueryExecutable executable = compiler.compile(xquery);

            XQueryEvaluator evaluator = executable.load();
            // Passage de la variable externe $doc
            evaluator.setExternalVariable(
                new QName(&#34;doc&#34;),
                document
            );

            XdmValue result = evaluator.evaluate();

            // Sérialisation du résultat
            StringWriter writer = new StringWriter();
            Serializer serializer = processor.newSerializer(writer);
            serializer.serializeXdmValue(result);

            System.out.println(writer.toString());

        } catch (SaxonApiException e) {
            System.err.println(&#34;Erreur lors de l&#39;exécution XQuery : &#34; &#43; e.getMessage());
            e.printStackTrace();
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1767046077463918336-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1767046077463918336");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{s=JSON.parse(n);function o(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}if(s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;white-space:pre-wrap;">'+o(s.output||"")+o(s.stderr||"")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;white-space:pre-wrap;">'+o(s.error||"")+o(s.stderr||"")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;white-space:pre-wrap;">'+o(s.error||"")+o(s.stderr||"")+"</pre>":t.innerHTML='<pre style="color:#222;background:#f0f0f0;padding:12px;border-radius:6px;white-space:pre-wrap;">'+o(n)+"</pre>",s.status==="compiling"){for(l=s.error||"",d=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(i=d.exec(l))!==null;){var s,i,l,d,r=i[1],h=i[2],m=i[3],u=i[4],a=parseInt(h,10)-1,c=(m+(u?u.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===r||t.textContent.trim().endsWith("/"+r)||t.textContent.trim().endsWith("\\"+r))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:a,ch:0},{line:a+1,ch:0},{className:"cm-java-error",title:c})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[a]=c)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><div class="flex flex-wrap justify-between"><a href=/orientee_donnees/docs/modules/c_module_xslt/xslt/autoevaluation_xslt/ class="flex align-center float-left book-icon"><img src=/orientee_donnees/svg/backward.svg alt=Previous title=Autoévaluation>
<span>Autoévaluation</span>
</a><a href=/orientee_donnees/docs/modules/c_module_xslt/xquery/laboratoire_xquery_avec_python_optionnel/ class="flex align-center float-right book-icon"><span>Laboratoire XQuery avec Python (optionnel)</span>
<img src=/orientee_donnees/svg/forward.svg alt=Next title="Laboratoire XQuery avec Python (optionnel)"></a></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#saxon-en-ligne>Saxon en ligne</a></li></ul></nav></div></aside></main></body></html>